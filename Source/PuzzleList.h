#pragma once
#include "Generate.h"
#include "Special.h"
#include "Random.h"

class PuzzleList {

public: 

	void GenerateAllN();
	void GenerateAllH();

	PuzzleList() {
		generator = std::make_shared<Generate>();
		specialCase = std::make_shared<Special>(generator);
	}

	PuzzleList(std::shared_ptr<Generate> generator) {
		this->generator = generator;
		this->specialCase = std::make_shared<Special>(generator);
	}

	void setLoadingHandle(HWND handle) {
		_handle = handle;
		generator->setLoadingHandle(handle);
	}

	void setSeed(int seed, bool isRNG, bool colorblind) {
		this->seed = seed;
		this->seedIsRNG = isRNG;
		this->colorblind = colorblind;
		if (seed >= 0) generator->seed(seed);
		else generator->seed(Random::rand());
		generator->colorblind = colorblind;
	}

	void CopyTargets();
	void RestoreLineWidths();

	//--------------------------Normal difficulty---------------------------

	void GenerateTutorialN();
	void GenerateSymmetryN();
	void GenerateQuarryN();
	void GenerateBunkerN(); //Can't randomize because panels refuse to render the symbols
	void GenerateSwampN();
	void GenerateTreehouseN();
	void GenerateTownN();
	void GenerateVaultsN();
	void GenerateTrianglePanelsN();
	void GenerateMountainN();
	void GenerateCavesN();

	//Environmental areas - unless I can figure out how to mess with the game's assets, randomizing most of these puzzles isn't happening anytime soon
	void GenerateOrchardN();
	void GenerateDesertN(); //Just scramble the positions for now
	void GenerateShadowsN(); //Can't randomize
	void GenerateKeepN();
	void GenerateMonasteryN(); //Can't randomize
	void GenerateJungleN();

	//-------------------------Hard difficulty--------------------------

	void GenerateTutorialH();
	void GenerateSymmetryH();
	void GenerateQuarryH();
	void GenerateBunkerH();
	void GenerateSwampH();
	void GenerateTreehouseH();
	void GenerateTownH();
	void GenerateVaultsH();
	void GenerateTrianglePanelsH();
	void GenerateMountainH();
	void GenerateCavesH();

	//Environmental areas - unless I can figure out how to mess with the game's assets, randomizing some of these puzzles isn't happening anytime soon
	void GenerateOrchardH();
	void GenerateDesertH(); //Just scramble the positions for now
	void GenerateShadowsH(); //Can't randomize
	void GenerateKeepH();
	void GenerateMonasteryH(); //Can't randomize
	void GenerateJungleH();

private:
	std::shared_ptr<Generate> generator;
	std::shared_ptr<Special> specialCase;
	HWND _handle = nullptr;
	int seed = 0;
	bool seedIsRNG = false;
	bool colorblind = false;

	template <class T> T pick_random(std::vector<T>& vec) { return vec[Random::rand() % vec.size()]; }
	template <class T> T pick_random(std::set<T>& set) { auto it = set.begin(); std::advance(it, Random::rand() % set.size()); return *it; }
	template <class T> T pop_random(std::vector<T>& vec) {
		int i = Random::rand() % vec.size();
		T item = vec[i];
		vec.erase(vec.begin() + i);
		return item;
	}
	template <class T> T pop_random(std::set<T>& set) {
		auto it = set.begin();
		std::advance(it, Random::rand() % set.size());
		T item = *it;
		set.erase(item);
		return item;
	}
};

const std::map<int, float> LineWidths =
{
{0x64,1},
{0x182,1},
{0x293,1},
{0x295,0.8},
{0x2c2,0.6},
{0xa3b5,0.8},
{0xa3b2,0.9},
{0x3629,0.5},
{0x3505,0.15},
{0xc335,0.75},
{0xc373,0.8},
{0x33d4,0.65},
{0x3481,1},
{0xa171,0.65},
{0x17cfb,0.8},
{0x4ca4,0.65},
{0x5d,1},
{0x5e,1},
{0x5f,1},
{0x60,1},
{0x61,1},
{0x18af,1},
{0x1b,1},
{0x12c9,1},
{0x1c,1},
{0x1d,1},
{0x1e,1},
{0x1f,1},
{0x20,1},
{0x21,1},
{0x1a54,1},
{0x3c12b,0.8},
{0x86,1},
{0x87,1},
{0x59,1},
{0x62,0.8},
{0x5c,0.6},
{0x8d,1},
{0x81,1},
{0x83,1},
{0x84,1},
{0x82,1},
{0x343a,1},
{0x17cc8,0.7},
{0xb0,1},
{0x22,0.8},
{0x23,0.8},
{0x24,0.8},
{0x25,0.8},
{0x26,0.8},
{0x7c,0.8},
{0x7e,0.8},
{0x75,0.8},
{0x73,0.8},
{0x77,0.8},
{0x79,0.8},
{0x65,0.7},
{0x6d,0.8},
{0x72,0.8},
{0x6f,0.9},
{0x70,0.9},
{0x71,0.85},
{0x76,0.85},
{0x9b8,0.75},
{0x3e8,0.75},
{0xa15,0.75},
{0xb53,0.75},
{0xb8d,0.75},
{0x1c349,1},
{0xa52,1},
{0xa57,1},
{0xa5b,1},
{0xa61,1},
{0xa64,1},
{0xa68,1},
{0x360d,1},
{0x143,0.7},
{0x3b,0.7},
{0x55,0.7},
{0x32f7,0.7},
{0x32ff,0.7},
{0xcc7b,0.7},
{0x339e,1},
{0x17ce7,0.8},
{0x698,0.8},
{0x48f,0.8},
{0x9f92,0.8},
{0x9fa0,1},
{0xa036,0.8},
{0x9da6,0.8},
{0xa049,0.8},
{0xa053,0.8},
{0x9f94,0.8},
{0x9f86,1},
{0xc339,1},
{0x9faa,0.8},
{0x422,0.7},
{0x6e3,0.7},
{0xa02d,0.7},
{0xc72,0.8},
{0x129d,0.7},
{0x8bb,0.7},
{0x78d,0.7},
{0x18313,0.7},
{0xa249,1},
{0x1c2df,1},
{0x1831e,1},
{0x1c260,1},
{0x1831c,1},
{0x1c2f3,1},
{0x1831d,1},
{0x1c2b1,1},
{0x1831b,1},
{0x4d18,0.7},
{0x1205,0.7},
{0x181ab,0.7},
{0x117a,0.7},
{0x17eca,0.7},
{0x18076,0.5},
{0x17c31,1},
{0x12d7,0.7},
{0xa015,1},
{0xa15c,0.7},
{0x9fff,0.7},
{0xa15f,0.7},
{0x3608,1},
{0x9e57,0.8},
{0x17c09,0.8},
{0x17cc4,0.9},
{0x1e5a,1},
{0x1e59,1},
{0x17cf0,0.8},
{0x3612,1},
{0x275ed,1},
{0x3678,0.8},
{0xe0c,1},
{0x1489,1},
{0x148a,1},
{0x14d9,1},
{0x14e7,1},
{0x14e8,1},
{0x3679,1},
{0x3675,1},
{0x3676,0.8},
{0x557,1},
{0x5f1,1},
{0x620,1},
{0x9f5,1},
{0x146c,1},
{0x3c12d,1},
{0x3686,1},
{0x14e9,1},
{0x3677,0.9},
{0x3c125,0.65},
{0x367c,0.9},
{0x17cac,1},
{0x34d4,1},
{0x21d5,1},
{0x3852,1},
{0x21b3,1},
{0x21b4,1},
{0x21b0,1},
{0x21af,1},
{0x21ae,1},
{0x3858,0.8},
{0x38663,1},
{0x21b5,1},
{0x21b6,1},
{0x21b7,0.9},
{0x21bb,0.9},
{0x9db5,0.9},
{0x9db1,0.9},
{0x3c124,0.9},
{0x9db3,0.8},
{0x9db4,0.9},
{0x275fa,0.8},
{0x17ca6,0.7},
{0xa3cb,0.65},
{0xa3cc,0.65},
{0xa3d0,0.65},
{0x334db,1},
{0xac74,0.8},
{0xac7a,0.8},
{0xa8e0,0.8},
{0x386fa,0.8},
{0x1c33f,0.8},
{0x196e2,0.8},
{0x1972a,0.8},
{0x19809,0.8},
{0x19806,0.8},
{0x196f8,0.8},
{0x1972f,0.8},
{0x19797,0.8},
{0x1979a,0.8},
{0x197e0,0.8},
{0x197e8,0.8},
{0x197e5,0.8},
{0x19650,0.8},
{0x334dc,1},
{0x198b5,0.8},
{0x198bd,0.8},
{0x198bf,0.8},
{0x19771,0.8},
{0xa8dc,0.8},
{0x139,1.35},
{0x19dc,1},
{0x19e7,1},
{0x1a0f,1},
{0xa3a8,0.6},
{0x33ea,1},
{0xa3b9,0.6},
{0x1be9,1},
{0xa3bb,0.6},
{0x1cd3,1},
{0xa3ad,0.6},
{0x1d3f,1},
{0x17d27,0.8},
{0x9e49,1},
{0xafb,0.8},
{0x3535,1},
{0x17d28,0.8},
{0x361b,1},
{0x360e,0.5},
{0x3317,0.5},
{0x3713,1},
{0xb10,1},
{0xc92,1},
{0x290,1},
{0x38,1},
{0x37,1},
{0x17ca4,1},
{0x9d9b,0.575},
{0x193a7,0.5},
{0x193aa,0.5},
{0x193ab,0.5},
{0x193a6,0.5},
{0xa054,0.7},
{0xa0c8,0.65},
{0x17d01,0.8},
{0x9f98,0.3},
{0x18590,0.65},
{0x28ae3,0.8},
{0x28938,0.4},
{0x79df,0.3},
{0x28b39,0.3},
{0x28998,0.9},
{0x28a0d,1},
{0x28a69,1},
{0x28a79,0.6},
{0x2896a,0.6},
{0x17c71,0.8},
{0x28ac7,0.9},
{0x28ac8,0.9},
{0x28aca,0.9},
{0x28acb,0.9},
{0x28acc,0.9},
{0x2899c,1},
{0x28a33,1},
{0x28abf,1},
{0x28ac0,1},
{0x28ac1,1},
{0x28ad9,0.9},
{0x17f5f,0.7},
{0x34e4,0.6},
{0x34e3,1},
{0x334d8,0.85},
{0x3c0c,0.7},
{0x3c08,0.7},
{0x32f5,1},
{0x17d02,0.8},
{0x17f89,0.7},
{0x815,0.55},
{0x3553,0.8},
{0x3552,0.8},
{0x354e,0.8},
{0x3549,0.8},
{0x354f,0.8},
{0x3545,0.8},
{0xa168,0.65},
{0x33ab2,0.7},
{0x17cf7,0.8},
{0x17cdf,0.7},
{0x17f9b,0.8},
{0x2c4,1},
{0x767,0.6},
{0x2c6,0.6},
{0x70e,0.6},
{0x70f,0.6},
{0x87d,0.6},
{0x2c7,0.6},
{0x17cab,0.7},
{0x26d,1},
{0x26e,1},
{0x26f,1},
{0xc3f,1},
{0xc41,1},
{0x14b2,1},
{0x3616,1},
{0x337fa,1},
{0x17caa,1},
{0x15add,1},
{0x3702,1},
{0x17c2e,0.8},
{0x9de0,1},
{0x9f7d,1},
{0x9fdc,1},
{0x9ff7,1},
{0x9f82,1},
{0x9ff8,0.8},
{0x9d9f,1},
{0x9da1,0.8},
{0x9da2,0.8},
{0x9daf,0.8},
{0xa099,1},
{0xa010,0.8},
{0xa01b,0.8},
{0xa01f,0.8},
{0x34bc5,1},
{0x34bc6,1},
{0x17e63,1},
{0x17e67,1},
{0xa079,0.8},
{0x56e,0.9},
{0x469,0.85},
{0x472,0.75},
{0x262,0.75},
{0x474,0.85},
{0x553,0.75},
{0x56f,0.6},
{0x390,0.75},
{0x10ca,0.75},
{0x983,0.75},
{0x984,0.75},
{0x986,0.75},
{0x985,0.75},
{0x987,0.75},
{0x181a9,0.75},
{0x609,0.5},
{0x999,0.75},
{0x99d,0.75},
{0x9a0,0.7},
{0x9a1,0.7},
{0x2,0.7},
{0x4,0.7},
{0x5,0.7},
{0x13e6,0.7},
{0x596,0.7},
{0x18488,0.5},
{0x982,0.7},
{0x97f,0.7},
{0x98f,0.6},
{0x990,0.6},
{0x17c0d,0.6},
{0x17c0e,0.7},
{0x7,0.7},
{0x8,0.75},
{0x9,0.7},
{0xa,0.6},
{0x1,0.75},
{0x14d2,0.75},
{0x14d4,0.7},
{0x14d1,0.6},
{0x181f5,0.6},
{0x9db8,0.7},
{0x3b2,0.6},
{0xa1e,0.6},
{0xc2e,0.6},
{0xe3a,0.6},
{0x9a6,0.5},
{0x9ab,0.75},
{0x9ad,0.7},
{0x9ae,0.85},
{0x9af,0.7},
{0x6,0.7},
{0x17e2b,0.5},
{0x17c0a,0.9},
{0x17e07,0.9},
{0x3615,1},
{0x17c05,0.9},
{0x17c02,0.9},
{0x17c95,0.7},
{0x288c,1},
{0x2886,0.9},
{0x17d72,1},
{0x17d8f,1},
{0x17d74,1},
{0x17dac,1},
{0x17d9e,1},
{0x17db9,1},
{0x17d9c,1},
{0x17dc2,1},
{0x17dc4,1},
{0xa182,1},
{0x2700b,1},
{0x17dc8,1},
{0x17dc7,1},
{0x17ce4,1},
{0x17d2d,1},
{0x17d6c,0.9},
{0x17d9b,1},
{0x17d99,1},
{0x17daa,1},
{0x17d97,1},
{0x17bdf,1},
{0x17d91,0.9},
{0x17dc6,0.9},
{0x17e3c,1},
{0x17e4d,1},
{0x17e4f,1},
{0x17e52,0.8},
{0x17e5b,0.75},
{0x17e5f,1},
{0x17e61,1},
{0x17fa9,0.8},
{0x17db3,1},
{0x17db5,1},
{0x17db6,1},
{0x17dc0,1},
{0x17dd7,1},
{0x17dd9,1},
{0x17db8,1},
{0x17ddc,1},
{0x17dd1,0.8},
{0x17dde,1},
{0x17de3,1},
{0x17dec,0.9},
{0x17dae,0.9},
{0x17db0,0.9},
{0x17ddb,0.9},
{0x17fa0,0.8},
{0x17d88,1},
{0x17db4,1},
{0x17d8c,1},
{0x17ce3,1},
{0x17dcd,1},
{0x17db2,1},
{0x17dcc,1},
{0x17dca,1},
{0x17d8e,1},
{0x17db7,1},
{0x17db1,1},
{0x17da2,1},
{0x3613,1},
{0x17cbc,1},
{0x37ff,0.8},
{0x42d,1},
{0x9f7f,0.65},
{0x17c34,0.5},
{0x17c42,0.8},
{0x2a6,0.65},
{0x3542,1},
{0x9e39,0.9},
{0x9e7a,1},
{0x9e71,1},
{0x9e72,1},
{0x9e69,1},
{0x9e7b,1},
{0x9e73,1},
{0x9e75,1},
{0x9e78,1},
{0x9e79,1},
{0x9e6c,1},
{0x9e6f,1},
{0x9e6b,1},
{0x33af5,0.8},
{0x33af7,0.8},
{0x9f6e,0.8},
{0x9ead,0.8},
{0x9eaf,0.8},
{0x9fd3,1},
{0x9fd4,1},
{0x9fd6,1},
{0x9fd7,1},
{0x9fd8,1},
{0x9e86,0.85},
{0x9fcc,1},
{0x9fce,1},
{0x9fcf,1},
{0x9fd0,1},
{0x9fd1,1},
{0x9fd2,1},
{0x9ed8,0.85},
{0x9eeb,0.38},
{0x17f93,0.8},
{0x9fc1,0.9},
{0x9f8e,0.9},
{0x9f01,0.9},
{0x9eff,0.9},
{0x9fda,0.9},
{0x17fa2,0.7},
{0x1983,1},
{0x1987,1},
{0xff8,0.8},
{0x334e1,1},
{0x21d7,1},
{0x17cf2,0.8},
{0x335ab,0.9},
{0x335ac,0.8},
{0x3369d,0.9},
{0x190,1},
{0x558,1},
{0x567,1},
{0x6fe,1},
{0x1a0d,0.7},
{0x8b8,1},
{0x973,1},
{0x97b,1},
{0x97d,1},
{0x97e,1},
{0x994,1},
{0x334d5,1},
{0x995,1},
{0x996,1},
{0x998,1},
{0x9a4,0.9},
{0x18a0,1},
{0xa72,0.9},
{0x32962,0.8},
{0x32966,1},
{0x1a31,0.8},
{0xb71,1},
{0x9dd5,0.75},
{0xa16e,0.65},
{0x288ea,0.75},
{0x288fc,0.75},
{0x289e7,0.75},
{0x288aa,0.75},
{0x17fb9,0.9},
{0xa16b,0.65},
{0xa2ce,0.65},
{0xa2d7,0.65},
{0xa2dd,0.65},
{0xa2ea,0.65},
{0x8f,1},
{0x6b,1},
{0x8b,1},
{0x8c,1},
{0x8a,1},
{0x89,1},
{0x6a,1},
{0x6c,1},
{0x27,1},
{0x28,1},
{0x29,1},
{0xa332,1},
{0x88e,1},
{0xbaf,0.9},
{0xbf3,0.92},
{0xc09,0.75},
{0xcdb,1},
{0x51f,1},
{0x524,1},
{0xcd4,1},
{0xcb9,1},
{0xca1,1},
{0xc80,1},
{0xc68,1},
{0xc59,1},
{0xc22,1},
{0x34f4,0.8},
{0x34ec,0.8},
{0x1c31a,0.75},
{0x1c319,0.75},
{0x356b,1},
{0x39b4,0.7},
{0x2faf6,1},
{0x27732,1},
{0x2773d,1},
{0x9e85,0.55},
{0x383a,0.85},
{0x9e56,0.85},
{0x9e5a,0.85},
{0x33961,0.8},
{0x383d,0.85},
{0x383f,0.85},
{0x3859,0.8},
{0x339bb,0.8},
{0x3d9a6,0.32},
{0x3d9a7,0.32},
{0x3c113,0.32},
{0x3c114,0.32},
{0x3d9aa,0.37},
{0x3d9a8,0.37},
{0x3d9a9,0.32},
};

//TODO: Add Jungle Vault